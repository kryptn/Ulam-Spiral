<!DOCTYPE html>
<html>
  <head>
    <title>Image map types</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>
    <script>

/** @constructor */
function CoordMapType(tileSize) {
  this.tileSize = tileSize;
}


CoordMapType.prototype.getTile = function(coord, zoom, ownerDocument) {
  var xhr = new XMLHttpRequest();
  console.log(coord);
  xhr.open("GET", "api/position/"+coord.x+"/" + coord.y*-1, false);
  xhr.send();
  var div = ownerDocument.createElement('div');
  div.innerHTML = coord + " " + xhr.responseText;
  div.style.width = this.tileSize.width + 'px';
  div.style.height = this.tileSize.height + 'px';
  div.style.color = "red";
  div.style.fontSize = '10';
  div.style.borderStyle = 'solid';
  div.style.borderWidth = '1px';
  div.style.borderColor = '#AAAAAA';
  return div;
};

var TypeOptions = {
  getTileUrl: function(coord, zoom) {

       
      return 'api' +
          '/' + zoom + '/' + coord.x + '/' + coord.y * -1;
  },
  tileSize: new google.maps.Size(25, 25),
  maxZoom: 2,
  minZoom: 2,
  name: 'Ulam'
};

var MapType = new google.maps.ImageMapType(TypeOptions);

function initialize() {
  var myLatlng = new google.maps.LatLng(0, 0);
  var mapOptions = {
    center: myLatlng,
    zoom: 1,
    streetViewControl: false,
    mapTypeControlOptions: {
      mapTypeIds: ['ulam']
    }
  };

  var map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);
  map.mapTypes.set('ulam', MapType);
  map.setMapTypeId('ulam');
  //map.overlayMapTypes.insertAt(0, new CoordMapType(new google.maps.Size(25, 25)));
}

// Normalizes the coords that tiles repeat across the x axis (horizontally)
// like the standard Google map tiles.

google.maps.event.addDomListener(window, 'load', initialize);

      </script>
  </head>
  <body>
    <div id="map-canvas"></div>
  </body>
</html>
